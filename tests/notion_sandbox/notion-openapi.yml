---
openapi: 3.1.0

info:
  title: notion-api
  version: 1.1.0
  description: >
    Compact Notion sandbox contract for Microcks-backed tests.

servers:
  - url: http://localhost:8080/rest/notion-api/1.1.0
    description: Microcks REST mock base

paths:
  /v1/pages:
    post:
      operationId: createPage
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        '200':
          description: Created page
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: page
                    id: 59833787-2cf9-4fdf-8782-e53db20768a5
                    created_time: '2023-01-15T10:30:00.000Z'
                    last_edited_time: '2023-01-16T14:22:00.000Z'
                    created_by:
                      object: user
                      id: 71e95936-2737-4e11-b03d-f174f6f13e90
                    last_edited_by:
                      object: user
                      id: 71e95936-2737-4e11-b03d-f174f6f13e90
                    archived: false
                    in_trash: false
                    parent:
                      type: workspace
                      workspace: true
                    properties:
                      Name:
                        # Workaround for naftiko/notion-sandbox#4:
                        # include required title property metadata fields.
                        id: title
                        type: title
                        title:
                          - type: text
                            text:
                              content: Upload Title
                            plain_text: Upload Title
                            annotations:
                              bold: false
                              italic: false
                              strikethrough: false
                              underline: false
                              code: false
                              color: default
                    url: https://www.notion.so/Upload-Title-59833787

  /v1/pages/59833787-2cf9-4fdf-8782-e53db20768a5:
    get:
      operationId: retrievePage
      responses:
        '200':
          description: Page
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: page
                    id: 59833787-2cf9-4fdf-8782-e53db20768a5
                    created_time: '2023-01-15T10:30:00.000Z'
                    last_edited_time: '2023-01-16T14:22:00.000Z'
                    created_by:
                      object: user
                      id: 71e95936-2737-4e11-b03d-f174f6f13e90
                    last_edited_by:
                      object: user
                      id: 71e95936-2737-4e11-b03d-f174f6f13e90
                    archived: false
                    in_trash: false
                    parent:
                      type: workspace
                      workspace: true
                    properties:
                      Name:
                        id: title
                        type: title
                        title:
                          - type: text
                            text:
                              content: Upload Title
                            plain_text: Upload Title
                            annotations:
                              bold: false
                              italic: false
                              strikethrough: false
                              underline: false
                              code: false
                              color: default
                    url: https://www.notion.so/Upload-Title-59833787
    patch:
      operationId: updatePage
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        '200':
          description: Updated page
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: page
                    id: 59833787-2cf9-4fdf-8782-e53db20768a5
                    created_time: '2023-01-15T10:30:00.000Z'
                    last_edited_time: '2023-01-16T14:22:00.000Z'
                    created_by:
                      object: user
                      id: 71e95936-2737-4e11-b03d-f174f6f13e90
                    last_edited_by:
                      object: user
                      id: 71e95936-2737-4e11-b03d-f174f6f13e90
                    archived: false
                    in_trash: false
                    parent:
                      type: workspace
                      workspace: true
                    properties:
                      Name:
                        id: title
                        type: title
                        title:
                          - type: text
                            text:
                              content: Upload Title
                            plain_text: Upload Title
                            annotations:
                              bold: false
                              italic: false
                              strikethrough: false
                              underline: false
                              code: false
                              color: default
                    url: https://www.notion.so/Upload-Title-59833787

  /v1/pages/598337872cf94fdf8782e53db20768a5:
    patch:
      operationId: updatePageHex
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        '200':
          description: Updated page
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: page
                    id: 59833787-2cf9-4fdf-8782-e53db20768a5
                    created_time: '2023-01-15T10:30:00.000Z'
                    last_edited_time: '2023-01-16T14:22:00.000Z'
                    created_by:
                      object: user
                      id: 71e95936-2737-4e11-b03d-f174f6f13e90
                    last_edited_by:
                      object: user
                      id: 71e95936-2737-4e11-b03d-f174f6f13e90
                    archived: false
                    in_trash: false
                    parent:
                      type: workspace
                      workspace: true
                    properties:
                      Name:
                        id: title
                        type: title
                        title:
                          - type: text
                            text:
                              content: Upload Title
                            plain_text: Upload Title
                            annotations:
                              bold: false
                              italic: false
                              strikethrough: false
                              underline: false
                              code: false
                              color: default
                    url: https://www.notion.so/Upload-Title-59833787

  /v1/blocks/59833787-2cf9-4fdf-8782-e53db20768a5/children:
    get:
      operationId: listChildren
      responses:
        '200':
          description: Child blocks
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: list
                    type: block
                    block: {}
                    has_more: false
                    results:
                      - object: block
                        id: c02fc1d3-db8b-45c5-a222-27595b15aea7
                        parent:
                          type: page_id
                          page_id: 59833787-2cf9-4fdf-8782-e53db20768a5
                        created_time: '2023-02-24T21:06:00.000Z'
                        last_edited_time: '2023-02-24T21:06:00.000Z'
                        has_children: false
                        archived: false
                        in_trash: false
                        type: paragraph
                        paragraph:
                          rich_text:
                            - type: text
                              text:
                                content: Hello from Microcks upload test
                              plain_text: Hello from Microcks upload test
                              annotations:
                                bold: false
                                italic: false
                                strikethrough: false
                                underline: false
                                code: false
                                color: default
                          color: default
    patch:
      operationId: appendChildren
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        '200':
          description: Appended blocks
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: list
                    type: block
                    block: {}
                    has_more: false
                    results:
                      - object: block
                        id: 30f89f8f-57ff-4f6c-a13d-4720d0d4f123
                        parent:
                          type: page_id
                          page_id: 59833787-2cf9-4fdf-8782-e53db20768a5
                        created_time: '2023-02-24T21:06:00.000Z'
                        last_edited_time: '2023-02-24T21:06:00.000Z'
                        has_children: false
                        archived: false
                        in_trash: false
                        type: paragraph
                        paragraph:
                          rich_text:
                            - type: text
                              text:
                                content: Hello from Microcks upload test
                              plain_text: Hello from Microcks upload test
                              annotations:
                                bold: false
                                italic: false
                                strikethrough: false
                                underline: false
                                code: false
                                color: default
                          color: default

  /v1/blocks/c02fc1d3-db8b-45c5-a222-27595b15aea7:
    delete:
      operationId: deleteBlock
      responses:
        '200':
          description: Deleted block
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: block
                    id: c02fc1d3-db8b-45c5-a222-27595b15aea7
                    parent:
                      type: page_id
                      page_id: 59833787-2cf9-4fdf-8782-e53db20768a5
                    created_time: '2023-02-24T21:06:00.000Z'
                    last_edited_time: '2023-02-24T21:06:00.000Z'
                    has_children: false
                    archived: true
                    in_trash: true
                    type: paragraph
                    paragraph:
                      rich_text:
                        - type: text
                          text:
                            content: Hello from Microcks upload test
                          plain_text: Hello from Microcks upload test
                          annotations:
                            bold: false
                            italic: false
                            strikethrough: false
                            underline: false
                            code: false
                            color: default
                      color: default

  /v1/blocks/c02fc1d3-db8b-45c5-a222-27595b15aea7/children:
    get:
      operationId: listChildrenForParagraph
      responses:
        '200':
          description: Child blocks for nested paragraph
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: list
                    type: block
                    block: {}
                    has_more: false
                    results: []

  /v1/comments:
    get:
      operationId: listComments
      parameters:
        - name: block_id
          in: query
          required: false
          schema:
            type: string
        - name: page_size
          in: query
          required: false
          schema:
            type: integer
        - name: start_cursor
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Comments for a block
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
              examples:
                Success:
                  value:
                    object: list
                    type: comment
                    comment: {}
                    has_more: false
                    results: []
